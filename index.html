<!DOCTYPE html>
<html>
<head>
  <title>UBC Leaflet Map Haviaggio</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <style>
    #map { height: 100vh; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    var map = L.map('map').setView([49.2606, -123.2460], 15);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    function style(feature) {
      // Define the style of your GeoJSON layer
      return {
        fillColor: '#ff7800',
        weight: 2,
        opacity: 1,
        color: 'white',
        fillOpacity: 0.7
      };
    }

    function highlightFeature(e) {
      // define what happens when hover
      var layer = e.target;
      layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
      });
      if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
      }
    }

    function resetHighlight(e) {
      // Reset to the default style on mouseout
      geojsonLayer.resetStyle(e.target);
    }

    function onEachFeature(feature, layer) {
      // Bind events for each feature
      layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight
      });
    }

    var geojsonLayer; // Declare this outside so it can be accessed by resetHighlight

    var geojsonUrl = "https://raw.githubusercontent.com/UBCGeodata/ubcv-parking/7b0824dd4ed4b1f099809f176a46f60e0ca8368f/geojson/ubcv_parking_www_poly.geojson";
    
    $.getJSON(geojsonUrl, function(data) {
      // Load the GeoJSON layer
      geojsonLayer = L.geoJson(data, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);
    }).fail(function() {
      console.error('Could not retrieve the GeoJSON file.');
    });
  </script>
</body>
</html>
